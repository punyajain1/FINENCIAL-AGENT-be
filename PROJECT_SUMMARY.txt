================================================================================
FINENCIAL ADVISER - PROJECT SUMMARY
================================================================================

üéØ WHAT IT DOES
================================================================================
An AI-powered finencial adviser that provides real-time analysis and 
recommendations for cryptocurrencies (Bitcoin, Ethereum) and precious metals 
(Gold, Silver). It combines market data, news sentiment analysis, and Google's 
Gemini AI to give personalized investment guidance with automated portfolio 
monitoring.


üõ†Ô∏è TECH STACK
================================================================================

CORE TECHNOLOGIES
-----------------
- Runtime: Node.js with TypeScript
- Framework: Express.js (REST API)
- Database: PostgreSQL with Prisma ORM
- Real-time: WebSockets (ws library) for live news updates

AI/ML SERVICES
--------------
- Google Gemini AI (@google/generative-ai, @google/genai)
  ‚Üí Conversational AI with Google Search grounding for real-time web data
- HuggingFace FinBERT (@huggingface/inference)
  ‚Üí Financial sentiment analysis on news articles

EXTERNAL APIs
-------------
- CoinGecko API ‚Üí Real-time cryptocurrency prices and historical data
- Metals-API / Gold API ‚Üí Precious metals pricing
- NewsAPI / GNews / Currents API ‚Üí Multi-source news aggregation

KEY LIBRARIES
-------------
- node-cron ‚Üí Scheduled background jobs (every 5 minutes)
- node-cache ‚Üí In-memory caching with database persistence
- winston ‚Üí Structured logging
- express-validator & zod ‚Üí Request validation
- express-rate-limit ‚Üí API rate limiting
- axios ‚Üí HTTP requests


üîÑ HOW IT WORKS
================================================================================

1. PORTFOLIO MANAGEMENT
-----------------------
Users can add crypto/metal assets with purchase price and amount. The system:
- Fetches current prices every 5 minutes via cron jobs
- Calculates profit/loss, price changes, and total portfolio value
- Uses Google Gemini AI to analyze each asset with:
  ‚Ä¢ Technical indicators (7-day moving averages, volatility, trends)
  ‚Ä¢ News sentiment scores
  ‚Ä¢ Risk assessment
- Generates BUY/SELL/HOLD recommendations with confidence scores and reasoning

2. INTELLIGENT CHATBOT
-----------------------
- Powered by Gemini 2.5 Flash with Google Search grounding
- When users ask questions, the AI:
  ‚Ä¢ Searches the web in real-time for current market information
  ‚Ä¢ Cites sources (URLs) and shows search queries used
  ‚Ä¢ Maintains conversation context (last 10 messages)
  ‚Ä¢ Provides personalized advice based on portfolio data
- Chat history stored in PostgreSQL for continuity

3. NEWS AGGREGATION & SENTIMENT ANALYSIS
-----------------------------------------
- Automatic fetching every 5 minutes from multiple news APIs
- For each article:
  ‚Ä¢ FinBERT analyzes sentiment (positive/negative/neutral with confidence)
  ‚Ä¢ Calculates relevance score to specific assets
  ‚Ä¢ Deduplicates articles across sources
- WebSocket server broadcasts new articles to connected clients in real-time
- News stored in database with sentiment scores, indexed by asset type

4. BACKGROUND AUTOMATION (CRON JOBS)
-------------------------------------
Runs automatically at scheduled intervals:
- Every 5 minutes: 
  ‚Ä¢ Analyze all portfolio assets
  ‚Ä¢ Fetch latest news for portfolio assets
- Daily at midnight: Clean expired cache entries
- Weekly: Remove news older than 30 days

5. CACHING STRATEGY
-------------------
Two-tier caching system to avoid expensive API calls and improve performance:

TIER 1: In-Memory Cache (node-cache)
  ‚Ä¢ Super fast access (stored in RAM)
  ‚Ä¢ Lost when server restarts
  ‚Ä¢ Handles short-term, frequently-requested data

TIER 2: Database Cache (AnalysisCache table in PostgreSQL)
  ‚Ä¢ Persistent storage (survives server restarts)
  ‚Ä¢ Slower than memory but faster than external APIs
  ‚Ä¢ Used as backup when memory cache misses

CACHE DURATIONS:
  ‚Ä¢ Crypto prices (BTC, ETH) ‚Üí 1 minute (prices change frequently)
  ‚Ä¢ Metal prices (Gold, Silver) ‚Üí 1 minute (real-time pricing needed)
  ‚Ä¢ News articles ‚Üí 5 minutes (news updates every 5 min via cron)
  ‚Ä¢ Sentiment analysis ‚Üí 1 hour (FinBERT results don't change for same text)
  ‚Ä¢ Historical price data (7-day) ‚Üí 5 minutes (used for trend analysis)
  ‚Ä¢ Technical indicators ‚Üí 5 minutes (calculated from historical data)

HOW IT WORKS:
  1. Request comes in (e.g., "Get Bitcoin price")
  2. Check in-memory cache ‚Üí Found? Return it immediately!
  3. If not in memory, check database cache ‚Üí Found? Return it!
  4. If not in database, call external API (CoinGecko)
  5. Store result in both memory + database with expiration time
  6. Return result to user

BENEFITS:
  ‚Ä¢ Faster responses - No waiting for external APIs
  ‚Ä¢ Save money - Free API tiers have request limits (CoinGecko: 10-50 calls/min)
  ‚Ä¢ Reliability - If API is down, cache can still serve recent data
  ‚Ä¢ Better UX - Users get instant results instead of waiting

AUTOMATIC CLEANUP:
  ‚Ä¢ Daily at midnight ‚Üí Deletes expired cache entries from database
  ‚Ä¢ Prevents database from filling up with stale data

EXAMPLE: Without caching, 3 users viewing Bitcoin would make 3 API calls.
         With caching, 1 API call serves all 3 users (within 1 minute).

6. MARKET DATA SERVICE
----------------------
- Fetches real-time prices for BTC, ETH, XAU (gold), XAG (silver)
- Retrieves 7-day historical data for trend analysis
- Calculates technical indicators:
  ‚Ä¢ 7-day price change percentage
  ‚Ä¢ Volatility (standard deviation)
  ‚Ä¢ Moving averages
  ‚Ä¢ Trend direction (UP/DOWN/SIDEWAYS)


üìä DATA FLOW EXAMPLES
================================================================================

EXAMPLE 1: User adds Bitcoin to portfolio
------------------------------------------
1. Asset stored in Portfolio table with buying price
2. Cron job triggers every 5 minutes
3. System fetches current BTC price from CoinGecko
4. Fetches 7-day historical prices and calculates technical indicators
5. Fetches recent Bitcoin news from multiple sources
6. FinBERT analyzes sentiment of each article
7. All data fed to Gemini AI to generate recommendation
8. Recommendation stored and returned to user
9. WebSocket broadcasts any new Bitcoin news to connected clients

EXAMPLE 2: User asks chatbot "Should I buy Ethereum now?"
----------------------------------------------------------
1. Message stored in ChatHistory table
2. Sent to Gemini AI with Google Search enabled
3. Gemini searches web for current Ethereum market data
4. Returns answer with live data + source URLs + search queries used
5. Response saved to database with sources and confidence score


üîê KEY FEATURES
================================================================================
- Multi-source data: Combines live prices, news, and AI analysis
- Real-time updates: WebSocket pushes news instantly
- Persistent storage: All data (portfolio, news, chats, cache) in PostgreSQL
- Error handling: Winston logging, rate limiting, validation middleware
- Automated monitoring: Set-it-and-forget-it portfolio tracking
- Source transparency: Shows which websites AI used for answers
- Scalable caching: Reduces API calls and improves performance


üöÄ ARCHITECTURE HIGHLIGHTS
================================================================================
The system is event-driven with multiple concurrent processes:
- HTTP server handles REST API requests
- WebSocket server maintains persistent connections for real-time updates
- Cron scheduler runs background tasks independently
- All services share the same PostgreSQL database through Prisma
- Caching layer sits between services and external APIs
- Modular service architecture (each service handles one domain)

This creates a self-sustaining investment advisor that continuously monitors 
markets, analyzes sentiment, and provides AI-powered guidance without manual 
intervention.


üìã DATABASE SCHEMA (via Prisma)
================================================================================
Portfolio ‚Üí Stores user's crypto/metal holdings with buying prices
News ‚Üí Stores articles with sentiment scores and related assets
ChatHistory ‚Üí Stores conversation messages with sources and confidence
AnalysisCache ‚Üí Stores temporary cached data with expiration times


üîë REQUIRED API KEYS
================================================================================
- GEMINI_API_KEY (Required) ‚Üí Google AI for chatbot and analysis
- HUGGINGFACE_API_KEY ‚Üí For FinBERT sentiment analysis
- NEWS_API_KEY / GNEWS_API_KEY / CURRENTS_API_KEY ‚Üí For news aggregation
- METALS_API_KEY ‚Üí For precious metals pricing
- COINGECKO_API_KEY (Optional) ‚Üí Higher rate limits for crypto data
- DATABASE_URL ‚Üí PostgreSQL connection string


üìù NOTES
================================================================================
- All prices in USD
- Supported assets: BTC, ETH, XAU (Gold), XAG (Silver)
- Rate limiting applied to prevent API abuse
- Automatic cleanup of old data to manage storage
- TypeScript for type safety across the entire codebase
- Environment-based configuration (development/production modes)

================================================================================
Generated: November 10, 2025
Project: Trading Agent Backend (FINENCIAL-AGENT-be)
================================================================================
